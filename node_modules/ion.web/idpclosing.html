<!DOCTYPE html>
<html>
<head>
    <title>Authentication page</title>
    <!-- Workaround to work in IE11 too -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge;chrome=1" />
    <meta charset="utf-8" />
</head>

<body>
    <p id="p1"></p>
<script>

    function getParameterByName(name) {
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
        var results = regex.exec(location.search);
        return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    window.addEventListener('load', function() {
        var outcome = getParameterByName('outcome').toLowerCase() === 'true';
        var error = getParameterByName('error');

        // Write an object into the localstorage
        window.localStorage.setItem('idpResult', JSON.stringify({
            outcome: outcome,
            error: error
        }));

        // Close itself
        window.close();

        try {
            document.getElementById('p1').innerHTML = "This page should close automatically. Please close it manually if this doesn't happen.";
        } catch (e) {
        }
    });

</script>
</body>
</html>
